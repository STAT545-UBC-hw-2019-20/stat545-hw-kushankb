---
title: "hw04"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
###Load library 
```{r}
library(gapminder)
library(tidyverse)
library(ggplot2)
library(DT)
library(knitr)
```

## Exercise 1- Univariant option 1
Univariate Option 1
Make a tibble with one row per year, and columns for life expectancy for two or more countries.
Take advantage of this new data shape to scatterplot life expectancy for one country against that of another.
Re-lengthen the data.


### 1.1 Making simplified tibble for life expectancy in India and Canada: Making data more usable
```{r}
wide_data<-gapminder %>% 
  filter(country=="India" | country=="Canada") %>% 
  select(lifeExp, year, country) %>% 
  pivot_wider(id_cols =year,
              names_from = country,
              names_prefix = "Lf_",
              values_from = lifeExp)
DT::datatable(wide_data)
 # Do not convert to DT before plotting DT::datatable(wide_data)
  
```

### 1.2 Ploting the life expectancy of India against Canada
One can see how the range of the two countries vary. Can also see that both the countries have an increasing trend and probably a good linear correlation. 
```{r}
wide_data %>% 
  ggplot(aes(Lf_Canada, Lf_India))+
  geom_point(color="blue", size=6, shape=19)+
  theme_bw()
```


###1.3 Re-lengthening the data back to normal
Not much to say about this. Used the pivot_longer function to re-lengthen the data back. 
```{r}
wide_data %>% 
  pivot_longer(cols=-year,
               names_to ="Country",
               names_prefix="Lf_",
               values_to = "LifeExp") %>% 
DT::datatable()
```



##Exercise 2
Multivariate Option 1
Make a tibble with one row per year, and columns for life expectancy and GDP per capita (or two other numeric variables) for two or more countries.
Re-lengthen the data.

###2.1 Making simplified tibble for life expectancy in India and Canada
```{r}
wide_data2<-gapminder %>% 
  filter(country=="India" | country=="Canada") %>% 
  select(lifeExp, year, country, gdpPercap) %>% 
  pivot_wider (id_cols =year,
              names_from = country,
              names_sep = c("_"),
              values_from = c(lifeExp,gdpPercap))
DT::datatable(wide_data2)
```

###2.2 Re-lengthening the data


```{r}
wide_data2 %>% 
  pivot_longer (cols=-year,
               names_to =c(".value","country"),
               names_sep="_",
               values_to = c("LifeExp","gdpPercap")) %>%  
DT::datatable()
```

## Exercise 3

Reading the data

```{r}
guest <- read_csv("https://raw.githubusercontent.com/STAT545-UBC/Classroom/master/data/wedding/attend.csv")
email <- read_csv("https://raw.githubusercontent.com/STAT545-UBC/Classroom/master/data/wedding/emails.csv")

```


### Exercise 3.1: 
For each guest in the guestlist (guest tibble), add a column for email address, which can be found in the email tibble.

To this, first the email dataframe is modified to represent two columns, name and actual email. Further, the new email dataframe is joined using left_join by using the 'name'. 

```{r}
email_n<-separate_rows(email, guest, sep=", ")%>% 
  rename(name=guest)

guest %>% 
  left_join(email_n, by="name") %>% 
DT::datatable()

```

###Exercise 3.2:
  Who do we have emails for, yet are not on the guestlist?
For this, anti_join works perfectly and makes the process extremely easy. 
```{r}
email_notguest<- email_n %>% 
  anti_join(guest, by="name")
knitr::kable(email_notguest)
```

###Exercise 3.3:
Make a guestlist that includes everyone we have emails for (in addition to those on the original guestlist).


```{r}
guest %>% 
  full_join(email_n, by="name") %>% 
DT::datatable()
```

