---
title: "Assignment 03"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r, message = FALSE, warning = FALSE}
# Installing packages
library(tidyverse)
library(gapminder)
library(ggplot2)
library(ggridges)#to make some really cool ridge plots!
library(scales)
```
## Task 5: Exploring how life expectancy changed over time on different continents.
The following table shows the minimum and maximum life expectancy and the corresponding countries on different continents every year. It can be seen that the minimum life expectancy was in Rwanada, Africa in the year 1992 and the maximum life expectancy was in Japan, Asia in the year 2007. The column MeanLifeExp shows the average life expectancy of all the countries in a particular continent during every given year. The Range column shows the range of life expectancy on each continent every year.  

```{r}
gapminder%>%
  group_by(continent,year) %>%  
  summarise(MinLifeExp=min(lifeExp),MinCountry=country[lifeExp==MinLifeExp], #this summarizes the minimum life                                          expectancy with the corresponding countries on each continent every year. 
            MaxLifeExp=max(lifeExp),MaxCountry=country[lifeExp==MaxLifeExp],#Shows maximum life expectancy with                                                             corresponding countries on each continent every year. 
            MeanLifeExp=round(mean(lifeExp),2)) %>%  # Calulates the mean life expectancy on each continent every                                                        year.
  mutate(Range=round((Range=MaxLifeExp-MinLifeExp))) %>%  # Calculates the range of life expectancy on each                                                                  continent every year.
  DT::datatable() 
```

Now, let's look at a graphical visualization of how the life expectancy change over time on different continents.
The graph shows how life expectancy has increased over time for all countries. It can also be infered that Oceania has had the highest life expectancy while Africa has the least. By looking at the slope of the lines, we can infer that there has been a steady increase in life expectancy in Asia and America while Oceania and Europe seems to have had slower increase in life expectancy. In case of Aftrica, a plateau can be observed in the plotted data post 1990 suggesting that there has been either no increase or possibly a decrease in life expactancy in Africa. These data points plausibly result in lowering the slope of the regression line for Africa too. It would be interesting to explore this further. 

```{r}
gapminder %>% 
  group_by(continent,year) %>%  
  summarise(MeanLifeExp=round(mean(lifeExp),2)) %>% #summarize gives one row with the results
  ggplot(aes(year, MeanLifeExp,color=continent))+ #color is for outline of the geom while fill is color inside
  geom_point(shape=19,size=3)+
  geom_smooth(method='lm')+ #lm has been used to add a linear regression line just to get an idea about the slope.
  labs(title="Change in mean life Expectancy over time",
               x="Years",
               y="Mean Life Expectancy")#+  geom_smooth(method="lm",alpha=0.1)
  
```


##Task 2: Minimum and Maximum GDP per capita for all continents
The following table shows the maximum and minimum GDP per capita for each continent and the corresponding countries and year. The data has been grouped by continent and further minimum and maximum GDP per capita values are shown with the cooresponding countries and year. It can be observed that the country with maximum GDP is Kuwait, Asia in the year 1957. And the country with the minimum GDP is Congo and DEm.Rep., Africa in the year 2002. 
Further, country-wise inferences can be made. For example in Africa, minimmum GDP per capita was found in the Congo and Dem.Rep in the year 2002 and the maximum was found in country Libya in the year 1977. Similar inferences can be made by the following table. 

```{r}
gapminder %>% 
  group_by(continent) %>% 
  summarise(MinGDP=min(gdpPercap),Mincountry=country[gdpPercap==MinGDP],Minyear=year[gdpPercap==MinGDP], 
            MaxGDP=max(gdpPercap),Maxcountry=country[gdpPercap==MaxGDP],Maxyear=year[gdpPercap==MaxGDP]) %>% 
    mutate(Range=round((Range=MaxGDP-MinGDP))) %>% 
  arrange(continent) %>% 
  knitr::kable()
```

Time to visualize the minimum and maximum GDP per capita for all the continents in more graphic form.It can be observed that Asia has the maximum range of GDP per capita where as Africa and Oceania have the smallest and comparable range. All the continents seem to have countries having similar minimum GDP per capita and varying maximum GDP per capita.

```{r}
gapminder %>% 
   group_by(continent) %>% 
   summarise(MinGDP=min(gdpPercap),MaxGDP=max(gdpPercap)) %>%
  ggplot(aes(size=2))+
  geom_point(aes(continent,MaxGDP, color="green"))+ #When you use axis(in aes) for multiple layers, it combines them together in one plot. 
  geom_point(aes(continent,MinGDP, color="blue"))+
  labs(title="Minimum and Maximum GDP of each",
               x="Continent",
               y="GDP per capita")+
  scale_color_discrete("",labels=c("Minimum GDP", "Maximum GDP"))
  
```


##Task 6
Asia seems to have the highest range of GDP per capita among other countries. Let's explore this a little further. The following plot shows that there are only a few countires which have GDP above 60,000$. It can also be observed that these countries don't have very high life expectancy, something that one would expect. It looks like there are only a handful countries that have GDP over 40,000 in Asia. 
```{r}
gapminder %>% 
  filter(continent=='Asia') %>%
  group_by(year) %>% 
  arrange(year) %>% 
  ggplot(aes(gdpPercap,lifeExp, size=pop/1000000))+
  geom_point(alpha=0.7, shape=21, color="purple")+
  labs(title="GDP per cap vs Life expectancy in Asia",
       x="GDP per capita",
       y="Life Expectancy")
  #geom_line(aes(year,lifeExp))
```

Now, let's try to find out the specific countries that have extremely high GDP per capita in Asia compared to the other countries and add them in a tibble. 

From the table, it can be inferred that most of the outliers (data points above 40000 GDP) belong to Kuwait except one (Singapore). There has been a steady increase in the Gross GDP of Kuwait over the years. However,the GDP per capita shows a different trend. Clearly, something significant happened in the 1970's that resulted in the decline of both GDP per capita and GROSS GDP in Kuwait.  

```{r}
gapminder %>% 
  filter(continent=='Asia') %>%
  group_by(year) %>% 
  arrange(pop) %>% 
  filter(gdpPercap>40000) %>% 
  mutate(GrossGDP=gdpPercap*pop) %>% 
  knitr::kable()
  
  
```




